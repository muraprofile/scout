import React, { useState } from 'react';
import { 
  BookOpen, 
  Target, 
  Users, 
  Video, 
  Dumbbell, 
  Heart, 
  AlertTriangle, 
  Check, 
  X,
  ChevronDown,
  ChevronUp,
  Activity,
  Scale,
  Shield,
  Star,
  Zap,
  GitMerge,
  Move,
  MousePointerClick,
  List,
  Lock,
  BarChart3,
  Calculator
} from 'lucide-react';

// --- Data Definitions ---

// v3.6 New: Authenticity Check
const AUTHENTICITY_CHECK = {
  id: '0',
  title: 'Step 0: 信頼性・実態チェック (Authenticity)',
  desc: '診断を始める前に、その数字が「本物」かを確認してください。ここをクリアしない場合、全ての診断は無効です。',
  checks: [
    { label: 'エンゲージメント率は適正か？', sub: 'フォロワー数に対して「いいね」が極端に少なくないか？（目安: 1%以下は危険）' },
    { label: 'コメント欄は生きているか？', sub: 'サクラ、BOT、日本語が怪しいコメントばかりではないか？' },
    { label: '他媒体への誘導力はあるか？', sub: 'YouTubeやInstagramなど、別プラットフォームでもファンがついてきているか？' }
  ]
};

const GATEWAY_STEPS = [
  {
    id: 'C',
    label: 'Step 1: ジム型チェック',
    question: '【スキル・メリット】重視？',
    sub: 'The Gym',
    desc: 'お金・筋肉・資格など、目に見える成果やスキルを求めている？',
    color: 'orange',
    icon: <Dumbbell className="w-5 h-5" />
  },
  {
    id: 'B',
    label: 'Step 2: シアター型チェック',
    question: '【物語・世界観】重視？',
    sub: 'The Theater',
    desc: '波乱万丈な人生を、映画やドキュメンタリーのように見ている？',
    color: 'violet',
    icon: <Video className="w-5 h-5" />
  },
  {
    id: 'A',
    label: 'Step 3: ミラー型チェック',
    question: '【共感・真似したい】重視？',
    sub: 'The Mirror',
    desc: '「私もこうなりたい！」「真似したい！」と思われている？',
    color: 'teal',
    icon: <Users className="w-5 h-5" />
  },
  {
    id: 'D',
    label: 'Step 4: アイドル型チェック',
    question: '【見た目・尊さ】重視？',
    sub: 'The Idol',
    desc: '中身より、外見やキャラそのものが「尊い」と推されている？',
    color: 'pink',
    icon: <Heart className="w-5 h-5" />
  }
];

// v3.6 New: KPI Table
const KPI_RANKING = [
  { rank: '🏅 プラチナ', people: '2,001人 〜', desc: 'Sランク案件：即決・最優先。収益最大化が見込める。', color: 'indigo' },
  { rank: '🥇 ゴールド', people: '1,001人 〜 2,000人', desc: 'Aランク案件：合格。安定した収益基盤になる。', color: 'emerald' },
  { rank: '🥈 シルバー', people: '501人 〜 1,000人', desc: 'Bランク案件：条件付合格。企画で補強可能か審議。', color: 'amber' },
  { rank: '🥉 ブロンズ', people: '300人 〜 500人', desc: 'Cランク案件：損益分岐ギリギリ。新人育成枠なら可。', color: 'slate' },
  { rank: '❌ 圏外', people: '〜 299人', desc: '不合格：コミュニティ過疎化リスク大。除外対象。', color: 'red' },
];

const SCORING_A = [
  { title: "1. キャラクター・世界観", levels: [{ score: 0, text: "宣伝ばかりで、その人らしさが見えない" }, { score: 2, text: "どんな人かはわかるけど、考え方がブレている" }, { score: 4, text: "「この人といえばコレ！」という一貫した世界観がある" }, { score: 6, text: "その人の生き方自体が、みんなの憧れブランドになっている" }] },
  { title: "2. リアルな日常見せ", levels: [{ score: 0, text: "普段の生活が全く見えない" }, { score: 2, text: "たまに見せるけど、作られた感じでリアルじゃない" }, { score: 4, text: "家事や食事など、リアルな裏側が見えて真似できる" }, { score: 6, text: "「その暮らし方」自体が流行りになり、みんなが真似している" }] },
  { title: "3. みんなで語れるテーマ", levels: [{ score: 0, text: "ファン同士で語り合える共通の話題がない" }, { score: 2, text: "話題がバラバラで、何で盛り上がればいいかわからない" }, { score: 4, text: "「〇〇についてならこの人！」という明確なテーマがある" }, { score: 6, text: "そのテーマの第一人者として、界隈の中心にいる" }] },
  { title: "4. 「わかる！」という悩み共有", levels: [{ score: 0, text: "悩みや弱音を一切見せない" }, { score: 2, text: "悩みは言うけど、ただの愚痴で共感できない" }, { score: 4, text: "「私と同じ悩みだ！」という人が集まっている" }, { score: 6, text: "深い悩みを分かち合う、仲間のような場所になっている" }] },
  { title: "5. 毎日のルーティン化", levels: [{ score: 0, text: "いつ投稿されるか全然わからない" }, { score: 4, text: "「朝はこれを見る」など、ファンの習慣になっている" }, { score: 6, text: "生活の一部（インフラ）になり、見ないと落ち着かないレベル" }] },
  { title: "6. 活動を続けられる力", levels: [{ score: 0, text: "投稿や企画が少なく、サボり気味" }, { score: 4, text: "ライブや企画を、自分でどんどん回せている" }, { score: 6, text: "イベントや運営もバリバリこなす、リーダー気質がある" }] },
  { title: "7. 人生を変える影響力", levels: [{ score: 0, text: "「かわいい」だけで、特に影響はない" }, { score: 4, text: "紹介した物が売れたり、生活習慣を真似されたりする" }, { score: 6, text: "進路や生き方の手本として、人生の決断に影響を与えている" }] },
  { title: "8. 近すぎず遠すぎない距離感", levels: [{ score: 0, text: "近すぎて友達感覚か、遠すぎて別世界の人" }, { score: 4, text: "親しみやすいけど憧れる、「身近なカリスマ」" }, { score: 6, text: "「将来こうなりたい」と思われる、理想のロールモデル" }] }
];

const SCORING_B = [
  { title: "1. 独自の言葉選び", levels: [{ score: 0, text: "どこにでもある普通の言葉しか使わない" }, { score: 4, text: "ファンだけに通じる「合言葉」や「名言」がある" }, { score: 6, text: "その人の言葉が流行語になったり、辞書に載るレベル" }] },
  { title: "2. 物語の面白さ", levels: [{ score: 0, text: "過去が謎で、ストーリーがない" }, { score: 4, text: "「挫折からの逆転劇」など、応援したくなる物語がある" }, { score: 6, text: "人生そのものがマンガのようにドラマチックで面白い" }] },
  { title: "3. ライバルや敵の設定", levels: [{ score: 0, text: "誰にでもいい顔をしていて、主張がない" }, { score: 4, text: "「古い常識 vs 私たち」のような構図がはっきりしている" }, { score: 6, text: "社会を変えるリーダーとして、時代の最先端にいる" }] },
  { title: "4. 行動に移す力", levels: [{ score: 0, text: "口だけで何も行動していない" }, { score: 4, text: "言ったことを実際に形（イベントや作品）にしている" }, { score: 6, text: "社会を巻き込んで、本当に世の中を変える実績を出している" }] },
  { title: "5. 愛されるダメな部分", levels: [{ score: 0, text: "完璧すぎて隙がない、または性格が悪いだけ" }, { score: 4, text: "「私が支えなきゃ」と思わせる、可愛い欠点がある" }, { score: 6, text: "ダメな部分さえも魅力になり、みんなで助け合う文化がある" }] }
];

const SCORING_C = [
  { title: "1. 実績のすごさ", levels: [{ score: 0, text: "実績がない、または嘘っぽい" }, { score: 4, text: "誰もが認める数字や結果（優勝、売上など）がある" }, { score: 6, text: "その道のレジェンドとして、圧倒的な信頼がある" }] },
  { title: "2. 真似しやすさ", levels: [{ score: 0, text: "天才すぎて、凡人には真似できない" }, { score: 4, text: "「こうすればできる」という手順がわかりやすい" }, { score: 6, text: "誰がやっても結果が出る、魔法のようなメソッドがある" }] },
  { title: "3. 切磋琢磨できる環境", levels: [{ score: 0, text: "一人で頑張るだけで、仲間がいない" }, { score: 4, text: "ランキングやチーム戦など、競い合える仕組みがある" }, { score: 6, text: "教え合い、助け合う文化が完全にできあがっている" }] },
  { title: "4. 成長が見える仕組み", levels: [{ score: 0, text: "どこまでやればいいかわからない" }, { score: 4, text: "ランクやバッジがあって、レベルアップが楽しい" }, { score: 6, text: "ここでのランクが、社会的なステータス（資格）になる" }] },
  { title: "5. フィードバックの質", levels: [{ score: 0, text: "やりっぱなしで、誰からも教えてもらえない" }, { score: 4, text: "添削やアドバイスをもらえる機会がある" }, { score: 6, text: "アドバイス自体が神コンテンツになり、みんなの勉強になる" }] }
];

const SCORING_D = [
  { title: "1. 鉄壁のプロ意識", levels: [{ score: 0, text: "脇が甘く、すぐ炎上したりスキャンダルが出る" }, { score: 4, text: "世界観を徹底して守り、生活感（生々しさ）を出さない" }, { score: 6, text: "存在自体が「神」や「天使」のような聖域になっている" }] },
  { title: "2. ファンのマナー管理", levels: [{ score: 0, text: "ファンが荒れていて、放置している" }, { score: 4, text: "ルールがあり、古参ファンが新規に優しく教えている" }, { score: 6, text: "「マナーが良いこと」がファンの誇りになっている" }] },
  { title: "3. 努力を見せる力", levels: [{ score: 0, text: "結果しか見せず、頑張っている姿が見えない" }, { score: 4, text: "裏側の圧倒的な努力を見せ、尊敬されている" }, { score: 6, text: "成長の過程がドラマになり、ファンが「親目線」で見守っている" }] },
  { title: "4. 安全な疑似恋愛", levels: [{ score: 0, text: "ガチ恋営業すぎて、金銭トラブルの匂いがする" }, { score: 4, text: "「みんなの恋人」を徹底し、特定の人を特別扱いしない" }, { score: 6, text: "恋愛を超えて「尊い」という感情になり、見返りを求められない" }] },
  { title: "5. 供給の安定性", levels: [{ score: 0, text: "気まぐれ更新で、ファンが離れてしまう" }, { score: 4, text: "毎日たっぷりの供給があり、他の推しを見る暇がない" }, { score: 6, text: "ファンが切り抜きや絵を作って盛り上げ、供給が止まらない" }] }
];

// --- Components ---
const ScoringCard = ({ title, metrics, maxScore, colorClass = "indigo" }) => {
  const [isOpen, setIsOpen] = useState(false);
  const passingScore = Math.ceil(maxScore * 0.65);
  
  const colors = {
    teal: "border-teal-500 bg-teal-50 text-teal-800",
    violet: "border-violet-500 bg-violet-50 text-violet-800",
    orange: "border-orange-500 bg-orange-50 text-orange-800",
    pink: "border-pink-500 bg-pink-50 text-pink-800",
    indigo: "border-indigo-500 bg-indigo-50 text-indigo-800"
  };
  
  const theme = colors[colorClass] || colors.indigo;

  return (
    <div className={`bg-white rounded-lg border-l-4 shadow-sm overflow-hidden mt-4 ${colorClass === 'teal' ? 'border-teal-500' : colorClass === 'violet' ? 'border-violet-500' : colorClass === 'orange' ? 'border-orange-500' : colorClass === 'pink' ? 'border-pink-500' : 'border-indigo-500'}`}>
      <button 
        onClick={() => setIsOpen(!isOpen)}
        className="w-full flex items-center justify-between p-4 bg-white hover:bg-slate-50 transition-colors"
      >
        <div className="flex items-center gap-3">
          <div className={`p-2 rounded-full ${theme.split(' ')[1]}`}>
             <Scale className={`w-5 h-5 ${theme.split(' ')[2]}`} />
          </div>
          <div className="text-left">
            <span className="font-bold text-slate-800 block text-sm md:text-base">{title}</span>
            <span className="text-xs text-slate-500">
              満点: <span className="font-bold text-slate-700">{maxScore}点</span> / 
              合格目安: <span className="font-bold text-slate-700">{passingScore}点〜</span>
            </span>
          </div>
        </div>
        <div className="flex items-center gap-2 text-xs text-slate-500 font-bold bg-slate-100 px-3 py-1.5 rounded-full shrink-0">
          {isOpen ? '閉じる' : '詳細'}
          {isOpen ? <ChevronUp className="w-4 h-4" /> : <ChevronDown className="w-4 h-4" />}
        </div>
      </button>
      
      {isOpen && (
        <div className="p-5 bg-slate-50/50 border-t border-slate-100 space-y-6">
          {metrics.map((metric, idx) => (
            <div key={idx} className="border-b border-slate-200 pb-4 last:border-0 last:pb-0">
              <h4 className="font-bold text-sm text-slate-800 mb-3 flex items-center gap-2">
                <span className={`w-1.5 h-4 rounded-full ${theme.split(' ')[1].replace('bg-', 'bg-').replace('50', '400')}`}></span>
                {metric.title}
              </h4>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs">
                {metric.levels.map((level, lIdx) => (
                  <div key={lIdx} className={`p-2.5 rounded border ${level.score === 0 ? 'bg-red-50 border-red-100 text-red-800' : level.score === 6 ? `bg-white border-${colorClass}-200 shadow-sm font-bold text-slate-800` : 'bg-white border-slate-100 text-slate-600'}`}>
                    <span className={`inline-block w-6 font-bold ${level.score === 0 ? 'text-red-600' : `text-${colorClass}-600`}`}>{level.score}:</span>
                    {level.text}
                  </div>
                ))}
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};

const PositioningMap = () => {
  return (
    <div className="relative bg-white rounded-xl shadow-sm p-4 md:p-8 border border-slate-200 aspect-square md:aspect-[21/9] overflow-hidden group">
      
      <div className="absolute inset-0 grid grid-cols-2 grid-rows-2">
        {/* Top Left: Type A (Mirror) */}
        <div className="bg-teal-50/40 border-r border-b border-slate-300 flex flex-col items-center justify-center p-2 md:p-4 relative hover:bg-teal-50/80 transition-colors duration-300">
          <div className="absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none">
            <Users className="w-32 md:w-64 h-32 md:h-64 text-teal-600" />
          </div>
          {/* Content centered to avoid overlap */}
          <div className="z-10 text-center transform transition-transform duration-300 hover:scale-105 max-w-[90%]">
            <div className="bg-teal-600 text-white text-[10px] md:text-sm font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full inline-block mb-2 md:mb-3 shadow-sm">Type A</div>
            <h4 className="text-xl md:text-4xl font-extrabold text-teal-900 mb-1 md:mb-2">Mirror</h4>
            <p className="text-[10px] md:text-base text-teal-700 font-bold tracking-wide mb-1 md:mb-2">共感・真似したい</p>
            <div className="h-0.5 w-8 md:w-12 bg-teal-400 mx-auto mb-2 md:mb-3"></div>
            <p className="text-[10px] md:text-sm text-slate-600 font-medium leading-tight">
              憧れの日常を真似する<br/>
              <span className="text-teal-700 font-bold">◎ 安定・最強</span>
            </p>
          </div>
        </div>

        {/* Top Right: Type C (Gym) */}
        <div className="bg-orange-50/40 border-b border-slate-300 flex flex-col items-center justify-center p-2 md:p-4 relative hover:bg-orange-50/80 transition-colors duration-300">
          <div className="absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none">
            <Dumbbell className="w-32 md:w-64 h-32 md:h-64 text-orange-600" />
          </div>
          <div className="z-10 text-center transform transition-transform duration-300 hover:scale-105 max-w-[90%]">
            <div className="bg-orange-600 text-white text-[10px] md:text-sm font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full inline-block mb-2 md:mb-3 shadow-sm">Type C</div>
            <h4 className="text-xl md:text-4xl font-extrabold text-orange-900 mb-1 md:mb-2">Gym</h4>
            <p className="text-[10px] md:text-base text-orange-700 font-bold tracking-wide mb-1 md:mb-2">スキル・成果</p>
            <div className="h-0.5 w-8 md:w-12 bg-orange-400 mx-auto mb-2 md:mb-3"></div>
            <p className="text-[10px] md:text-sm text-slate-600 font-medium leading-tight">
              実利のために汗をかく<br/>
              <span className="text-orange-700 font-bold">自走する組織</span>
            </p>
          </div>
        </div>

        {/* Bottom Left: Type D (Idol) */}
        <div className="bg-pink-50/40 border-r border-slate-300 flex flex-col items-center justify-center p-2 md:p-4 relative hover:bg-pink-50/80 transition-colors duration-300">
           <div className="absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none">
            <Heart className="w-32 md:w-64 h-32 md:h-64 text-pink-600" />
          </div>
          <div className="z-10 text-center transform transition-transform duration-300 hover:scale-105 max-w-[90%]">
             <div className="bg-pink-600 text-white text-[10px] md:text-sm font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full inline-block mb-2 md:mb-3 shadow-sm">Type D</div>
            <h4 className="text-xl md:text-4xl font-extrabold text-pink-900 mb-1 md:mb-2">Idol</h4>
            <p className="text-[10px] md:text-base text-pink-700 font-bold tracking-wide mb-1 md:mb-2">尊い・見た目</p>
            <div className="h-0.5 w-8 md:w-12 bg-pink-400 mx-auto mb-2 md:mb-3"></div>
             <p className="text-[10px] md:text-sm text-slate-600 font-medium leading-tight">
               尊さを愛でる聖域<br/>
               <span className="text-pink-700 font-bold">騎士団化が必須</span>
             </p>
          </div>
        </div>

        {/* Bottom Right: Type B (Theater) */}
        <div className="bg-violet-50/40 flex flex-col items-center justify-center p-2 md:p-4 relative hover:bg-violet-50/80 transition-colors duration-300">
           <div className="absolute inset-0 flex items-center justify-center opacity-10 pointer-events-none">
            <Video className="w-32 md:w-64 h-32 md:h-64 text-violet-600" />
          </div>
          <div className="z-10 text-center transform transition-transform duration-300 hover:scale-105 max-w-[90%]">
             <div className="bg-violet-600 text-white text-[10px] md:text-sm font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full inline-block mb-2 md:mb-3 shadow-sm">Type B</div>
            <h4 className="text-xl md:text-4xl font-extrabold text-violet-900 mb-1 md:mb-2">Theater</h4>
            <p className="text-[10px] md:text-base text-violet-700 font-bold tracking-wide mb-1 md:mb-2">物語・考え方</p>
            <div className="h-0.5 w-8 md:w-12 bg-violet-400 mx-auto mb-2 md:mb-3"></div>
             <p className="text-[10px] md:text-sm text-slate-600 font-medium leading-tight">
               壮大な物語を楽しむ<br/>
               <span className="text-violet-700 font-bold">信者・共犯者</span>
             </p>
          </div>
        </div>
      </div>

      {/* Axis Labels - Enlarged and Styled for Visibility */}
      <div className="absolute inset-0 pointer-events-none flex items-center justify-center">
        {/* Y Axis */}
        <div className="h-full w-0.5 bg-slate-400 relative shadow-sm">
          <div className="absolute top-2 -translate-x-1/2 bg-slate-800 text-white text-xs md:text-sm font-bold px-3 py-1.5 rounded-full whitespace-nowrap shadow-lg z-20 border border-slate-600">
            自分でやる派 (Player)
          </div>
          <div className="absolute bottom-2 -translate-x-1/2 bg-slate-800 text-white text-xs md:text-sm font-bold px-3 py-1.5 rounded-full whitespace-nowrap shadow-lg z-20 border border-slate-600">
            見る専派 (Audience)
          </div>
        </div>
        {/* X Axis */}
        <div className="w-full h-0.5 bg-slate-400 absolute shadow-sm">
           <div className="absolute left-2 -translate-y-1/2 bg-slate-800 text-white text-xs md:text-sm font-bold px-3 py-1.5 rounded-full whitespace-nowrap shadow-lg z-20 border border-slate-600">
            エモさ・好き (Emotional)
          </div>
          <div className="absolute right-2 -translate-y-1/2 bg-slate-800 text-white text-xs md:text-sm font-bold px-3 py-1.5 rounded-full whitespace-nowrap shadow-lg z-20 border border-slate-600">
            役立つ・機能 (Functional)
          </div>
        </div>
      </div>
    </div>
  );
};

const InfluencerDiagnosticSystem = () => {
  return (
    <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-indigo-100">
      {/* Header */}
      <header className="bg-indigo-900 text-white shadow-lg sticky top-0 z-50">
        <div className="max-w-6xl mx-auto px-4 md:px-6 py-4">
          <div className="flex justify-between items-center">
            <div>
              <div className="flex items-center gap-2 text-indigo-300 text-xs font-mono mb-1">
                <span className="bg-indigo-800 px-2 py-0.5 rounded">v3.6 (KPI Integrated)</span>
                <span className="border border-indigo-600 px-2 py-0.5 rounded text-xs">高校生モード</span>
              </div>
              <h1 className="text-lg md:text-xl font-bold tracking-tight">
                インフルエンサー・コミュニティ診断システム
              </h1>
            </div>
            <div className="hidden md:block text-right text-xs text-indigo-300">
              Target: コミュニティ事業部<br/>
              不正対策・KPI実装版
            </div>
          </div>
        </div>
      </header>

      <main className="max-w-6xl mx-auto px-4 md:px-6 py-8 space-y-12">
        
        {/* 1. Grand Architecture */}
        <section>
           <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <BookOpen className="w-6 h-6 text-indigo-600" />
            1. 全体マップ：4つのタイプ (Grand Architecture)
          </h2>
          
          {/* Positioning Map - Full Width */}
          <div className="mb-8">
             <PositioningMap />
          </div>

          {/* Description below the map */}
           <div className="bg-white rounded-xl shadow-sm p-6 border-l-4 border-indigo-600">
            <p className="text-slate-600 leading-relaxed mb-4 text-sm">
              インフルエンサーを「4つのタイプ」に分けて、一番成功しやすいスタイルを決めます。
              <br/>
              特に、上の図の左上にある<strong className="text-teal-600 bg-teal-50 px-1">【Type A】ミラー型（真似したい系）</strong>が一番オススメです。ファンが長く応援してくれます。
            </p>
            <div className="mt-4 space-y-2">
              <div className="flex items-center gap-2 text-xs text-slate-500">
                <MousePointerClick className="w-4 h-4" />
                <span>上の図で、それぞれのタイプの位置を確認してね！</span>
              </div>
            </div>
          </div>
        </section>

        {/* 2. Type Definitions (Catalog) - Moved up */}
        <section>
           <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <List className="w-6 h-6 text-indigo-600" />
            2. 各タイプの説明 (Type Definitions)
          </h2>
          
          <div className="space-y-12">
            {/* Type A Details */}
            <div id="type-a" className="scroll-mt-24">
              <div className="flex items-center gap-4 border-b-2 border-teal-500 pb-4 mb-6">
                <div className="bg-teal-100 p-3 rounded-lg shrink-0">
                  <Users className="w-6 h-6 md:w-8 md:h-8 text-teal-600" />
                </div>
                <div>
                  <h2 className="text-xl md:text-2xl font-bold text-slate-900">Type A: ミラー型 (Mirror)</h2>
                  <p className="text-teal-700 font-bold text-sm">【共感・真似したい】日常を真似する / 一番ファンが定着する</p>
                </div>
                <div className="ml-auto hidden sm:block">
                  <span className="bg-teal-600 text-white px-4 py-1.5 rounded-full text-sm font-bold">◎ 超オススメ</span>
                </div>
              </div>

              <div className="grid lg:grid-cols-3 gap-6 mb-6">
                {/* A-1 */}
                <div className="bg-white p-5 rounded-xl shadow-sm border border-teal-100">
                  <h3 className="font-bold text-teal-800 mb-1">A-1 人生変身型 (Life-shift)</h3>
                  <div className="text-xs text-slate-500 mb-3">考え方に共感 / ビフォーアフター</div>
                  <p className="text-sm text-slate-600 mb-3">
                    「私も変わりたい！」と思わせるタイプ。ダイエットや整形の成功者など。
                  </p>
                  <div className="bg-slate-50 p-2 rounded text-xs text-slate-500">
                    <span className="font-bold text-teal-700">例:</span> 明日花キララ、古川優香（ダイエット）、Emiri
                  </div>
                </div>
                {/* A-2 */}
                <div className="bg-white p-5 rounded-xl shadow-sm border border-teal-100">
                  <h3 className="font-bold text-teal-800 mb-1">A-2 キャラ推し型 (Personality)</h3>
                  <div className="text-xs text-slate-500 mb-3">キャラに共感 / エンタメ</div>
                  <p className="text-sm text-slate-600 mb-3">
                    友達みたいで親しみやすい。ファン同士の仲良しグループを作るのがカギ。
                  </p>
                  <div className="bg-slate-50 p-2 rounded text-xs text-slate-500">
                    <span className="font-bold text-teal-700">例:</span> 平成フラミンゴ、とうあ、なこなこカップル
                  </div>
                </div>
                {/* A-3 */}
                <div className="bg-white p-5 rounded-xl shadow-sm border-2 border-teal-500 relative">
                  <div className="absolute top-0 right-0 bg-teal-500 text-white text-[10px] px-2 py-0.5 rounded-bl font-bold">最強</div>
                  <h3 className="font-bold text-teal-800 mb-1">A-3 暮らし憧れ型 (Lifestyle)</h3>
                  <div className="text-xs text-slate-500 mb-3">日常に共感 / 憧れ</div>
                  <p className="text-sm text-slate-600 mb-3">
                    おしゃれな生活を見せるタイプ。「この人みたいな生活がしたい」と思われる。
                  </p>
                  <div className="bg-slate-50 p-2 rounded text-xs text-slate-500">
                    <span className="font-bold text-teal-700">例:</span> 辻希美、滝沢眞規子、伊原葵
                  </div>
                </div>
              </div>
              {/* Keywords & Triggers */}
              <div className="bg-teal-50 rounded-lg p-5">
                <div className="grid md:grid-cols-2 gap-6">
                  <div>
                    <h4 className="text-sm font-bold text-teal-800 mb-2">🎯 チェックポイント</h4>
                    <ul className="list-disc list-inside text-sm text-teal-900 space-y-1">
                      <li>「真似したい」「参考にしたい」と思われている？</li>
                      <li>「私も同じ悩みがある！」と共感されている？</li>
                      <li>Vlogやモーニングルーティンをよく上げている？</li>
                    </ul>
                  </div>
                  <div>
                    <h4 className="text-sm font-bold text-teal-800 mb-2">🔑 キーワード</h4>
                    <div className="flex flex-wrap gap-2">
                      {["Vlog", "ルーティン", "ママ", "丁寧な暮らし", "美容", "相談", "あるある"].map(k => (
                        <span key={k} className="bg-white text-teal-700 px-2 py-1 rounded text-xs shadow-sm">{k}</span>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Type B Details */}
            <div id="type-b" className="scroll-mt-24">
              <div className="flex items-center gap-4 border-b-2 border-violet-500 pb-4 mb-6">
                <div className="bg-violet-100 p-3 rounded-lg shrink-0">
                  <Video className="w-6 h-6 md:w-8 md:h-8 text-violet-600" />
                </div>
                <div>
                  <h2 className="text-xl md:text-2xl font-bold text-slate-900">Type B: シアター型 (Theater)</h2>
                  <p className="text-violet-700 font-bold text-sm">【物語・考え方】映画を見るように人生を楽しむ関係</p>
                </div>
                <div className="ml-auto hidden sm:block">
                  <span className="bg-violet-100 text-violet-800 px-4 py-1.5 rounded-full text-sm font-bold">◯ 条件付き</span>
                </div>
              </div>

              <div className="grid md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-5 rounded-xl shadow-sm border border-violet-100">
                  <h3 className="font-bold text-violet-800 mb-1">B-1 夢追い型 (Visionary)</h3>
                  <div className="text-xs text-slate-500 mb-2">希望・ワクワク・建設的</div>
                  <p className="text-sm text-slate-600">
                    でっかい夢を語って、みんなで新しい世界を作ろうとするタイプ。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-violet-600">例:</span> 西野亮廣、中田敦彦、本田圭佑</span>
                  </p>
                </div>
                <div className="bg-slate-100 p-5 rounded-xl border border-slate-200 opacity-80">
                  <div className="flex justify-between items-start">
                    <h3 className="font-bold text-slate-600 mb-1">B-2 物申す型 (Resistance)</h3>
                    <span className="bg-red-100 text-red-600 text-[10px] px-2 py-0.5 rounded font-bold">NG</span>
                  </div>
                  <div className="text-xs text-slate-500 mb-2">怒り・スリル</div>
                  <p className="text-sm text-slate-600">
                    世の中の常識にケンカを売るタイプ。平和になると人気が落ちるので採用しない。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-slate-500">例:</span> 暴露系、炎上系</span>
                  </p>
                </div>
              </div>
            </div>

            {/* Type C Details */}
            <div id="type-c" className="scroll-mt-24">
              <div className="flex items-center gap-4 border-b-2 border-orange-500 pb-4 mb-6">
                <div className="bg-orange-100 p-3 rounded-lg shrink-0">
                  <Dumbbell className="w-6 h-6 md:w-8 md:h-8 text-orange-600" />
                </div>
                <div>
                  <h2 className="text-xl md:text-2xl font-bold text-slate-900">Type C: ジム型 (Gym)</h2>
                  <p className="text-orange-700 font-bold text-sm">【スキル・成果】結果を出すために頑張る関係</p>
                </div>
                <div className="ml-auto hidden sm:block">
                  <span className="bg-orange-100 text-orange-800 px-4 py-1.5 rounded-full text-sm font-bold">◯ 条件付き</span>
                </div>
              </div>

              <div className="grid md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-5 rounded-xl shadow-sm border border-orange-100">
                  <h3 className="font-bold text-orange-800 mb-1">C-1 先生型 (Academy)</h3>
                  <div className="text-xs text-slate-500 mb-2">知識・ノウハウ / 教える</div>
                  <p className="text-sm text-slate-600">
                    知識を教える学校のようなタイプ。学び終わると卒業しちゃうのが悩み。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-orange-600">例:</span> 資格の先生、ビジネス解説</span>
                  </p>
                </div>
                <div className="bg-white p-5 rounded-xl shadow-sm border-2 border-orange-400 relative">
                  <div className="absolute top-0 right-0 bg-orange-400 text-white text-[10px] px-2 py-0.5 rounded-bl font-bold">推奨</div>
                  <h3 className="font-bold text-orange-800 mb-1">C-2 部活型 (Bootcamp)</h3>
                  <div className="text-xs text-slate-500 mb-2">習慣・行動 / 一緒にやる</div>
                  <p className="text-sm text-slate-600">
                    「一緒に頑張ろう！」と励ますコーチタイプ。仲間がいるから続く。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-orange-600">例:</span> 竹脇まりな（宅トレ）、朝活グループ</span>
                  </p>
                </div>
              </div>
            </div>

            {/* Type D Details */}
            <div id="type-d" className="scroll-mt-24">
              <div className="flex items-center gap-4 border-b-2 border-pink-500 pb-4 mb-6">
                <div className="bg-pink-100 p-3 rounded-lg shrink-0">
                  <Heart className="w-6 h-6 md:w-8 md:h-8 text-pink-600" />
                </div>
                <div>
                  <h2 className="text-xl md:text-2xl font-bold text-slate-900">Type D: アイドル型 (Idol)</h2>
                  <p className="text-pink-700 font-bold text-sm">【見た目・尊さ】存在そのものを「推す」関係</p>
                </div>
                <div className="ml-auto hidden sm:block">
                  <span className="bg-pink-100 text-pink-800 px-4 py-1.5 rounded-full text-sm font-bold">△ 例外のみ</span>
                </div>
              </div>

              <div className="bg-pink-50 p-4 rounded-lg border border-pink-200 mb-6">
                <h4 className="font-bold text-pink-800 mb-2 flex items-center gap-2">
                  <Shield className="w-4 h-4" />
                  成功の鍵：ファンが「騎士団」になること
                </h4>
                <p className="text-sm text-pink-900">
                  ただの人気者じゃダメ。<strong>「推しの顔に泥を塗らないように、ファンがお行儀よくする」</strong>という空気感が大事。
                </p>
              </div>

              <div className="grid md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-5 rounded-xl shadow-sm border border-pink-100">
                  <h3 className="font-bold text-pink-800 mb-1">D-1 聖域型 (Sanctuary)</h3>
                  <div className="text-xs text-slate-500 mb-2">見てるだけで幸せ / 遠い存在</div>
                  <p className="text-sm text-slate-600">
                    手が届かない完璧なアイドル。プロ意識が高く、スキャンダルがない。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-pink-600">例:</span> トップアイドル、人気Vtuber</span>
                  </p>
                </div>
                <div className="bg-slate-100 p-5 rounded-xl border border-slate-200 opacity-80">
                  <div className="flex justify-between items-start">
                    <h3 className="font-bold text-slate-600 mb-1">D-2 ガチ恋型 (Lounge)</h3>
                    <span className="bg-red-100 text-red-600 text-[10px] px-2 py-0.5 rounded font-bold">不合格</span>
                  </div>
                  <div className="text-xs text-slate-500 mb-2">嫉妬・トラブル</div>
                  <p className="text-sm text-slate-600">
                    距離が近すぎて、ファンが勘違いしちゃうタイプ。トラブルの元なのでNG。<br/>
                    <span className="text-xs text-slate-400 block mt-2"><span className="font-bold text-slate-500">例:</span> 色恋営業、DM返信する人</span>
                  </p>
                </div>
              </div>
            </div>

          </div>
        </section>

        {/* 3. Gateway Logic - Moved down */}
        <section>
          <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <GitMerge className="w-6 h-6 text-indigo-600" />
            3. 診断フローチャート (Gateway Logic)
          </h2>
          <div className="bg-slate-100 p-6 rounded-xl">
            
            {/* Authenticity Check (Step 0) */}
            <div className="bg-red-50 border border-red-200 rounded-lg p-5 mb-8">
              <h3 className="font-bold text-red-800 flex items-center gap-2 mb-3">
                <Lock className="w-5 h-5" />
                {AUTHENTICITY_CHECK.title}
              </h3>
              <p className="text-sm text-red-700 mb-4">{AUTHENTICITY_CHECK.desc}</p>
              <div className="space-y-2">
                {AUTHENTICITY_CHECK.checks.map((check, idx) => (
                   <div key={idx} className="flex items-start gap-2">
                     <AlertTriangle className="w-4 h-4 text-red-500 shrink-0 mt-0.5" />
                     <div>
                       <div className="text-sm font-bold text-red-900">{check.label}</div>
                       <div className="text-xs text-red-700">{check.sub}</div>
                     </div>
                   </div>
                ))}
              </div>
            </div>

            <p className="text-xs text-slate-500 mb-4 text-center">
              ※Step 0をクリアしたら、以下の優先順位（Priority）で判定してね。
            </p>
            <div className="flex flex-col gap-3">
              {GATEWAY_STEPS.map((step, idx) => (
                <div key={step.id} className={`relative flex items-center bg-white p-4 rounded-lg shadow-sm border-l-4 border-${step.color}-500 hover:shadow-md transition-shadow`}>
                  <div className={`bg-${step.color}-100 text-${step.color}-700 p-2 rounded-full mr-4 shrink-0`}>
                    {step.icon}
                  </div>
                  <div className="flex-grow">
                    <div className="flex justify-between items-center mb-1">
                      <span className={`text-xs font-bold text-${step.color}-600`}>{step.label}</span>
                      <span className="text-xs text-slate-400 font-mono">{step.sub}</span>
                    </div>
                    <h4 className="font-bold text-slate-800">{step.question}</h4>
                    <p className="text-xs text-slate-500 mt-1">{step.desc}</p>
                  </div>
                  <div className="ml-4 pl-4 border-l border-slate-100 flex flex-col items-center justify-center shrink-0">
                    <span className={`text-sm font-bold text-${step.color}-600`}>YES</span>
                    <span className="text-xs text-slate-400">↓</span>
                    <a href={`#type-${step.id.toLowerCase()}`} className={`text-xs font-bold bg-${step.color}-50 text-${step.color}-700 px-2 py-0.5 rounded hover:bg-${step.color}-100 transition-colors`}>Type {step.id}</a>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* 4. Scoring Criteria - Separated Category */}
        <section>
           <h2 className="text-xl md:text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2">
            <Scale className="w-6 h-6 text-indigo-600" />
            4. 詳しい採点基準 (Scoring Criteria)
          </h2>
          <div className="bg-white rounded-xl shadow-sm p-6 border border-slate-200">
             <p className="text-slate-600 mb-6 text-sm">
               タイプが決まったら、以下の基準で点数をつけてみよう。<br/>
               <span className="text-red-500 font-bold text-xs">※わからない項目は0点にすること。</span>
             </p>

             <div className="space-y-6">
               <div>
                 <h3 className="font-bold text-teal-800 border-b border-teal-200 pb-2 mb-2 flex items-center gap-2">
                   <Users className="w-5 h-5" /> Type A: ミラー型の採点
                 </h3>
                 <ScoringCard title="Type A: 8項目 × 6点満点" metrics={SCORING_A} maxScore={48} colorClass="teal" />
               </div>

               <div>
                 <h3 className="font-bold text-orange-800 border-b border-orange-200 pb-2 mb-2 flex items-center gap-2">
                   <Dumbbell className="w-5 h-5" /> Type C: ジム型の採点
                 </h3>
                 <ScoringCard title="Type C: 5項目 × 6点満点" metrics={SCORING_C} maxScore={30} colorClass="orange" />
               </div>

               <div>
                 <h3 className="font-bold text-pink-800 border-b border-pink-200 pb-2 mb-2 flex items-center gap-2">
                   <Heart className="w-5 h-5" /> Type D: アイドル型の採点
                 </h3>
                 <ScoringCard title="Type D: 5項目 × 6点満点" metrics={SCORING_D} maxScore={30} colorClass="pink" />
               </div>

               <div>
                 <h3 className="font-bold text-violet-800 border-b border-violet-200 pb-2 mb-2 flex items-center gap-2">
                   <Video className="w-5 h-5" /> Type B: シアター型の採点
                 </h3>
                 <ScoringCard title="Type B: 5項目 × 6点満点" metrics={SCORING_B} maxScore={30} colorClass="violet" />
               </div>
             </div>
          </div>
        </section>

        {/* 5. Final Decision - Updated with KPI */}
        <section className="bg-indigo-900 text-white rounded-xl p-8 shadow-xl">
          <h2 className="text-xl md:text-2xl font-bold mb-6 flex items-center gap-2">
            <Target className="w-6 h-6 text-yellow-400" />
            5. 最終判定 & KPI (Final Decision)
          </h2>
          
          {/* KPI Criteria Table */}
          <div className="mb-8 bg-indigo-800/50 p-5 rounded-lg border border-indigo-700">
            <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
               <BarChart3 className="w-5 h-5 text-emerald-400" />
               参加者数KPI基準 (フリーミアム)
            </h3>
            <p className="text-xs text-indigo-200 mb-4">
              スコア判定に加え、見込み参加者数（フォロワー数 × 推定CVR）での足切りを行います。
            </p>
            <div className="space-y-2">
               {KPI_RANKING.map((kpi, idx) => (
                 <div key={idx} className="flex flex-col md:flex-row md:items-center justify-between bg-indigo-900/50 p-3 rounded border border-indigo-700/50">
                    <div className="flex items-center gap-3 mb-2 md:mb-0">
                       <span className="font-bold text-sm md:text-base min-w-[100px]">{kpi.rank}</span>
                       <span className={`text-xs font-bold px-2 py-1 rounded bg-${kpi.color}-500/20 text-${kpi.color}-300 border border-${kpi.color}-500/30`}>
                         {kpi.people}
                       </span>
                    </div>
                    <div className="text-xs text-indigo-200">{kpi.desc}</div>
                 </div>
               ))}
            </div>
          </div>

          {/* Score Criteria */}
          <div className="bg-indigo-800/30 p-5 rounded-lg border border-indigo-700">
             <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
               <Calculator className="w-5 h-5 text-yellow-400" />
               スコア判定基準
            </h3>
            <div className="grid md:grid-cols-2 gap-6">
                {/* Type A Criteria */}
                <div className="bg-white text-slate-800 rounded-lg overflow-hidden shadow-lg">
                <div className="bg-teal-600 text-white p-3 font-bold text-center border-b border-teal-700">
                    Type A (48点満点)
                </div>
                <div className="p-4 space-y-3">
                    <div className="flex items-center justify-between p-3 bg-indigo-50 rounded border-l-4 border-indigo-600">
                    <div>
                        <div className="text-xs font-bold text-indigo-800">🏅 合格</div>
                    </div>
                    <div className="text-xl font-bold text-indigo-700">32点〜</div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-amber-50 rounded border-l-4 border-amber-500">
                    <div>
                        <div className="text-xs font-bold text-amber-800">🥈 条件付</div>
                    </div>
                    <div className="text-xl font-bold text-amber-700">24点〜</div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-red-50 rounded border-l-4 border-red-500">
                    <div>
                        <div className="text-xs font-bold text-red-800">❌ 不合格</div>
                    </div>
                    <div className="text-xl font-bold text-red-700">〜23点</div>
                    </div>
                </div>
                </div>

                {/* Type B/C/D Criteria */}
                <div className="bg-white text-slate-800 rounded-lg overflow-hidden shadow-lg">
                <div className="bg-slate-600 text-white p-3 font-bold text-center border-b border-slate-700">
                    Type B / C / D (30点満点)
                </div>
                <div className="p-4 space-y-3">
                    <div className="flex items-center justify-between p-3 bg-indigo-50 rounded border-l-4 border-indigo-600">
                    <div>
                        <div className="text-xs font-bold text-indigo-800">🏅 合格</div>
                    </div>
                    <div className="text-xl font-bold text-indigo-700">20点〜</div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-amber-50 rounded border-l-4 border-amber-500">
                    <div>
                        <div className="text-xs font-bold text-amber-800">🥈 条件付</div>
                    </div>
                    <div className="text-xl font-bold text-amber-700">15点〜</div>
                    </div>
                    <div className="flex items-center justify-between p-3 bg-red-50 rounded border-l-4 border-red-500">
                    <div>
                        <div className="text-xs font-bold text-red-800">❌ 不合格</div>
                    </div>
                    <div className="text-xl font-bold text-red-700">〜14点</div>
                    </div>
                </div>
                </div>
            </div>
          </div>
        </section>

      </main>

      <footer className="max-w-6xl mx-auto px-6 py-8 text-center text-slate-400 text-xs">
        <p>© 2025 Community Division. Confidential Internal Document.</p>
      </footer>
    </div>
  );
};

export default InfluencerDiagnosticSystem;
